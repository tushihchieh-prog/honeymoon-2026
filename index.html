<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ä¸­æ­èœœæœˆä¹‹æ—… â€¢ å°ˆå±¬è¡Œç¨‹ç‰ˆ</title>
    <!-- 1. å¼•å…¥ React å’Œ ReactDOM (æ ¸å¿ƒå¼•æ“) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 2. å¼•å…¥ Babel (è®“ç€è¦½å™¨çœ‹æ‡‚ JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        input, textarea {
            transition: all 0.2s;
        }
        input:focus, textarea:focus {
            outline: 2px solid #fb7185;
            border-radius: 4px;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="root"></div>

    <!-- 3. è¨­å®š type="text/babel" -->
    <script type="text/babel">
        // å¾å…¨åŸŸè®Šæ•¸ç²å– React åŠŸèƒ½
        const { useState, useEffect, useMemo, useRef } = React;
        
        // --- åœ–ç¤ºçµ„ä»¶ ---
        const Icon = ({ name, size = 18, className = "" }) => {
            const icons = {
                mapPin: <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>,
                mapPinDot: <circle cx="12" cy="10" r="3"></circle>,
                calendar: <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>,
                calendarLine: <line x1="16" y1="2" x2="16" y2="6"></line>,
                calendarLine2: <line x1="8" y1="2" x2="8" y2="6"></line>,
                calendarLine3: <line x1="3" y1="10" x2="21" y2="10"></line>,
                clock: <circle cx="12" cy="12" r="10"></circle>,
                clockHand: <polyline points="12 6 12 12 16 14"></polyline>,
                arrowRight: <line x1="5" y1="12" x2="19" y2="12"></line>,
                arrowRightTip: <polyline points="12 5 19 12 12 19"></polyline>,
                heart: <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>,
                euro: <path d="M4 10h12"></path>,
                euro2: <path d="M4 14h9"></path>,
                euroCurve: <path d="M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2"></path>,
                bed: <path d="M2 4v16"></path>,
                bed2: <path d="M2 8h18a2 2 0 0 1 2 2v10"></path>,
                bed3: <path d="M2 17h20"></path>,
                bed4: <path d="M6 8v9"></path>,
                star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>,
                train: <rect x="2" y="5" width="20" height="14" rx="2"></rect>,
                trainLine: <line x1="2" y1="10" x2="22" y2="10"></line>,
                trainWheel1: <line x1="7" y1="15" x2="7.01" y2="15"></line>,
                trainWheel2: <line x1="11" y1="15" x2="11.01" y2="15"></line>,
                plane: <path d="M22 2L2 9.5l9 3 2.5 7.5L16 14l5-4z"></path>,
                cat: <path d="M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7 .58 8a10 10 0 0 1 0 4c-1 1 .82 7.42-.58 8-1.4.58-4.64-.26-6.42-2.26a9.84 9.84 0 0 1-4 0c-1.78 2-5.02 2.84-6.42 2.26-1.4-.58.42-7-.58-8a10 10 0 0 1 0-4c1-1-.82-7.42.58-8 1.4-.58 4.64.26 6.42 2.26.65-.17 1.33-.26 2-.26z"></path>,
                eye: <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>,
                eyeCircle: <circle cx="12" cy="12" r="3"></circle>,
                eyeOff: <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>,
                eyeOffLine: <line x1="1" y1="1" x2="23" y2="23"></line>,
                edit: <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>,
                editPen: <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>,
                trash: <polyline points="3 6 5 6 21 6"></polyline>,
                trashBin: <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>,
                plus: <line x1="12" y1="5" x2="12" y2="19"></line>,
                plusH: <line x1="5" y1="12" x2="19" y2="12"></line>,
                check: <polyline points="20 6 9 17 4 12"></polyline>,
                refresh: <polyline points="23 4 23 10 17 10"></polyline>,
                refreshArrow: <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>,
                sun: <circle cx="12" cy="12" r="5"></circle>,
                sunRays: <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>,
                chevronDown: <polyline points="6 9 12 15 18 9"></polyline>,
                clipboard: <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>,
                clipboardTop: <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>,
                shoppingBag: <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>,
                shoppingLine: <line x1="3" y1="6" x2="21" y2="6"></line>,
                shoppingCurve: <path d="M16 10a4 4 0 0 1-8 0"></path>,
                share: <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>,
                shareArrow: <polyline points="16 6 12 2 8 6"></polyline>,
                shareLine: <line x1="12" y1="2" x2="12" y2="15"></line>,
                cloud: <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>,
                save: <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>,
                saveDisk: <polyline points="17 21 17 13 7 13 7 21"></polyline>,
                saveLine: <polyline points="7 3 7 8 15 8"></polyline>,
                offline: <path d="M1 1l22 22M18.36 10a8 8 0 0 1 9 9m-9-9a8 8 0 0 0-1.26.1M9 20h9a5 5 0 0 0 0-10"></path>
            };

            const getPath = (n) => {
                if (n === 'mapPin') return React.createElement(React.Fragment, null, icons.mapPin, icons.mapPinDot);
                if (n === 'calendar') return React.createElement(React.Fragment, null, icons.calendar, icons.calendarLine, icons.calendarLine2, icons.calendarLine3);
                if (n === 'clock') return React.createElement(React.Fragment, null, icons.clock, icons.clockHand);
                if (n === 'arrowRight') return React.createElement(React.Fragment, null, icons.arrowRight, icons.arrowRightTip);
                if (n === 'euro') return React.createElement(React.Fragment, null, icons.euro, icons.euro2, icons.euroCurve);
                if (n === 'bed') return React.createElement(React.Fragment, null, icons.bed, icons.bed2, icons.bed3, icons.bed4);
                if (n === 'train') return React.createElement(React.Fragment, null, icons.train, icons.trainLine, icons.trainWheel1, icons.trainWheel2);
                if (n === 'eye') return React.createElement(React.Fragment, null, icons.eye, icons.eyeCircle);
                if (n === 'eyeOff') return React.createElement(React.Fragment, null, icons.eyeOff, icons.eyeOffLine);
                if (n === 'edit') return React.createElement(React.Fragment, null, icons.edit, icons.editPen);
                if (n === 'trash') return React.createElement(React.Fragment, null, icons.trash, icons.trashBin);
                if (n === 'plus') return React.createElement(React.Fragment, null, icons.plus, icons.plusH);
                if (n === 'refresh') return React.createElement(React.Fragment, null, icons.refresh, icons.refreshArrow);
                if (n === 'sun') return React.createElement(React.Fragment, null, icons.sun, icons.sunRays);
                if (n === 'chevronDown') return icons.chevronDown;
                if (n === 'clipboard') return React.createElement(React.Fragment, null, icons.clipboard, icons.clipboardTop);
                if (n === 'shopping') return React.createElement(React.Fragment, null, icons.shoppingBag, icons.shoppingLine, icons.shoppingCurve);
                if (n === 'share') return React.createElement(React.Fragment, null, icons.share, icons.shareArrow, icons.shareLine);
                if (n === 'cloud') return icons.cloud;
                if (n === 'save') return React.createElement(React.Fragment, null, icons.save, icons.saveDisk, icons.saveLine);
                if (n === 'offline') return React.createElement(React.Fragment, null, icons.cloud, React.createElement("line", {x1:"2", y1:"2", x2:"22", y2:"22"}));
                return icons[n];
            };

            return React.createElement(
                "svg",
                {
                    xmlns: "http://www.w3.org/2000/svg",
                    width: size,
                    height: size,
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: "2",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    className: className
                },
                getPath(name)
            );
        };

        const cityCoordinates = {
            Departure: { lat: 25.03, lon: 121.56, name: "Taipei", avgTemp: "18-22Â°C" },
            Budapest: { lat: 47.49, lon: 19.04, name: "Budapest", avgTemp: "3-11Â°C" },
            Vienna: { lat: 48.20, lon: 16.37, name: "Vienna", avgTemp: "2-10Â°C" },
            LakeDistrict: { lat: 47.71, lon: 13.62, name: "Bad Ischl", avgTemp: "0-9Â°C" }, 
            CKTown: { lat: 48.81, lon: 14.31, name: "Cesky Krumlov", avgTemp: "1-8Â°C" },
            Prague: { lat: 50.07, lon: 14.43, name: "Prague", avgTemp: "2-9Â°C" }
        };

        const defaultItineraryData = {
            Departure: {
                city: "è¡Œå‰æº–å‚™ & å°åŒ—å‡ºç™¼",
                label: "æº–å‚™ & å•Ÿç¨‹",
                color: "from-slate-700 to-slate-900",
                bg: "bg-slate-50",
                text: "text-slate-700",
                border: "border-slate-200",
                description: "è¬å…¨æº–å‚™èˆ‡èœœæœˆä¹‹æ—…çš„èµ·é»ã€‚",
                days: [
                    {
                        day: "Pre-Trip",
                        date: "å‡ºç™¼å‰",
                        title: "è¡Œå‰æº–å‚™æ¸…å–®",
                        imgKeyword: "travel planning passport money",
                        highlights: [
                            "è³¼è²·æ­æ´²ä¸Šç¶²ç¶²å¡ (eSIM æˆ–å¯¦é«”å¡)",
                            "æŠ•ä¿æ—…éŠå¹³å®‰éšª + ä¸ä¾¿éšª (âš ï¸ å»ºè­°åŒ…å«ç”³æ ¹è­‰æ˜)",
                            "æª¢æŸ¥è­·ç…§æ•ˆæœŸ (âš ï¸ éœ€é›¢å¢ƒæ—¥ç®—èµ· 6 å€‹æœˆä»¥ä¸Š)",
                            "æº–å‚™æ­å…ƒç¾é‡‘èˆ‡ä¿¡ç”¨å¡ (å»ºè­°é–‹é€šæµ·å¤–ææ¬¾)",
                            "é è¨‚ CK Shuttle (åº«å€«æ´›å¤«æ¥é§)"
                        ],
                        stay: "æº«æš–çš„å®¶",
                        transport: "N/A",
                        costs: [
                            { label: "ç¶²å¡ (2äºº)", value: "3,000", type: "TWD_Prep", amount: 3000 },
                            { label: "ä¿éšª (2äºº)", value: "6,000", type: "TWD_Prep", amount: 6000 },
                            { label: "å…¶ä»–é›œæ”¯", value: "5,000", type: "TWD_Prep", amount: 5000 }
                        ]
                    },
                    {
                        day: "Day 0",
                        date: "2026/3/5 (å››) æ™šé–“",
                        title: "å‰å¾€æ©Ÿå ´ Check-in",
                        imgKeyword: "Taoyuan International Airport night",
                        highlights: [
                            "ğŸŒ™ æ™šä¸Š 21:30 å·¦å³æŠµé”æ¡ƒåœ’æ©Ÿå ´",
                            "æº–å‚™æ­ä¹˜å‡Œæ™¨ 00:20 çš„é˜¿è¯é…‹èˆªç©º (EK387)",
                            "âš ï¸ æ³¨æ„ï¼šé›–ç„¶æ˜¯ 3/6 çš„é£›æ©Ÿï¼Œä½† 3/5 æ™šä¸Šå°±è¦å»æ©Ÿå ´å›‰ï¼",
                            "æœŸå¾…ï¼šèœœæœˆä¹‹æ—…æ­£å¼å±•é–‹ â¤ï¸"
                        ],
                        stay: "æ©Ÿä¸Šä¼‘æ¯",
                        transport: "æ©Ÿå ´æ¥é€",
                        costs: [
                            { label: "æ©Ÿå ´æ¥é€", value: "1,200", type: "TWD_Prep", amount: 1200 }
                        ]
                    },
                    {
                        day: "Day 1",
                        date: "2026/3/6 (äº”)",
                        title: "00:20 èµ·é£› & åŒæ—¥æŠµé”ç¶­ä¹Ÿç´",
                        imgKeyword: "Emirates airline first class",
                        highlights: [
                            "âœˆï¸ 00:20 å°åŒ—èµ·é£› (EK387) -> æœæ‹œè½‰æ©Ÿ",
                            "ğŸ‡¦ğŸ‡¹ 12:25 æŠµé”ç¶­ä¹Ÿç´ (EK127) (è³ºåˆ°åŠå¤©ï¼)",
                            "ğŸšŒ ä¸‹åˆï¼šæ©Ÿå ´ç›´æ¥è½‰ä¹˜ FlixBus å‰å¾€å¸ƒé”ä½©æ–¯",
                            "æ™šä¸Šï¼šå…¥ä½é£¯åº—ï¼Œäº«ç”¨å¸ƒé”ä½©æ–¯ç¬¬ä¸€é “æ™šé¤"
                        ],
                        stay: "Three Corners Lifestyle Hotel",
                        transport: "é˜¿è¯é…‹èˆªç©º + è·¨åœ‹å·´å£«",
                        costs: [
                            { label: "æ©Ÿç¥¨ (å–®äºº)", value: "32,437", type: "TWD_Flight", amount: 32437 },
                            { label: "è·¨åœ‹å·´å£«", value: "20 EUR", type: "EUR_Transport", amount: 20 }
                        ]
                    }
                ]
            },
            Budapest: {
                city: "åŒˆç‰™åˆ© å¸ƒé”ä½©æ–¯",
                label: "å¸ƒé”ä½©æ–¯",
                color: "from-rose-500 to-pink-600",
                bg: "bg-rose-50",
                text: "text-rose-700",
                border: "border-rose-200",
                description: "æº«æ³‰èˆ‡å¤œæ™¯ä¹‹éƒ½ï¼Œå¤šç‘™æ²³ç•”çš„æµªæ¼«èµ·é»ã€‚",
                days: [
                    {
                        day: "Day 1",
                        date: "2026/3/6 (äº”)",
                        title: "æŠµé”å¸ƒé”ä½©æ–¯ & æ²³ç•”æ¼«æ­¥",
                        imgKeyword: "Budapest parliament night river",
                        highlights: [
                            "17:00 å·¦å³æŠµé”å¸ƒé”ä½©æ–¯ (NÃ©pliget å·´å£«ç«™)",
                            "ğŸ’¡ å»ºè­°ï¼šè³¼è²· 72å°æ™‚äº¤é€šå¡ï¼Œéš¨ä¸Šéš¨ä¸‹è¶…æ–¹ä¾¿",
                            "æ™šé¤ï¼šGettÃ³ GulyÃ¡s (å“å˜—é“åœ°åŒˆç‰™åˆ©ç‡‰ç‰›è‚‰)",
                            "æ™šä¸Šï¼šå¤šç‘™æ²³ç•”æ•£æ­¥ï¼Œé çœºåœ‹æœƒå¤§å»ˆå¤œæ™¯"
                        ],
                        stay: "Three Corners Lifestyle Hotel",
                        transport: "å¸‚å€äº¤é€š (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "ä½å®¿ (4æ™šç¸½è¨ˆ)", value: "14,895", type: "TWD_Hotel", amount: 14895 },
                            { label: "72häº¤é€šå¡(2äºº)", value: "28 EUR", type: "EUR_Transport", amount: 28 },
                            { label: "é¤è²»(å«é…’æ°´)", value: "50 EUR", type: "EUR_Food", amount: 50 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 2",
                        date: "2026/3/7 (å…­)",
                        title: "å¸ƒé”å€ï¼šåŸå ¡ã€è›‹ç³•èˆ‡æµªæ¼«éŠèˆ¹",
                        imgKeyword: "Fisherman's Bastion Budapest",
                        highlights: [
                            "ğŸ° ä¸Šåˆï¼šæ¼äººå ¡ (å…è²»å€æ‹ç…§) & é¦¬åŠ ä»€æ•™å ‚ (å¤–è§€)",
                            "ğŸ° ä¸‹åˆèŒ¶ï¼šRuszwurm Confectionery (ç™¾å¹´çš‡å®¤ç”œé»)",
                            "âœ¨ èœœæœˆé‡é»ï¼šå¤šç‘™æ²³æ™šå®´éŠèˆ¹ (Legenda æˆ–é¡ä¼¼)",
                            "é«”é©—ï¼šåœ¨èˆ¹ä¸Šäº«ç”¨æ™šé¤ï¼Œçœ‹é‡‘è‰²åœ‹æœƒå¤§å»ˆå¾èº«é‚Šæµé"
                        ],
                        stay: "Three Corners Lifestyle Hotel",
                        transport: "å¸‚å€åœ°éµ/å·´å£« (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "æ™šå®´éŠèˆ¹", value: "120 EUR", type: "EUR_Activity", amount: 120 },
                            { label: "åˆé¤+åˆèŒ¶", value: "40 EUR", type: "EUR_Food", amount: 40 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 3",
                        date: "2026/3/8 (æ—¥)",
                        title: "ä½©æ–¯å€ï¼šæº«æ³‰ã€å¸‚å ´èˆ‡å»¢å¢Ÿé…’å§",
                        imgKeyword: "SzÃ©chenyi Thermal Bath",
                        highlights: [
                            "ğŸ´ æ—©é¤/æ—©åˆé¤ï¼šä¸­å¤®å¸‚å ´ (Central Market Hall) åƒ LÃ¡ngos",
                            "â™¨ï¸ ä¸‹åˆï¼šå¡åˆ‡å°¼æº«æ³‰ (SzÃ©chenyi Thermal Bath) - å¿…é«”é©—ï¼",
                            "ğŸ¸ æ™šä¸Šï¼šSzimpla Kert å»¢å¢Ÿé…’å§ (é»æ¯èª¿é…’æ„Ÿå—æ°£æ°›)",
                            "æ™šé¤ï¼šMazel Tov (å»¢å¢Ÿé¢¨ç¶²ç¾é¤å»³)"
                        ],
                        stay: "Three Corners Lifestyle Hotel",
                        transport: "å¸‚å€åœ°éµ/æ­¥è¡Œ (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "æº«æ³‰é–€ç¥¨(2äºº)", value: "66 EUR", type: "EUR_Activity", amount: 66 },
                            { label: "é¤è²»(å¸‚å ´+é…’å§)", value: "70 EUR", type: "EUR_Food", amount: 70 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 4",
                        date: "2026/3/9 (ä¸€)",
                        title: "çŒ¶å¤ªå€èˆ‡å»¢å¢Ÿé…’å§æ°›åœ",
                        imgKeyword: "Budapest ruin bar",
                        highlights: [
                            "ä¸Šåˆï¼šç…™è‰è¡—æœƒå ‚ (å¤–è§€æ‹ç…§)",
                            "ğŸ½ï¸ åˆé¤ï¼šMazel Tov (âš ï¸ ç¶²ç¾é¤å»³ï¼Œå‹™å¿…æå‰è¨‚ä½)",
                            "ä¸‹åˆï¼šæ¼«éŠçŒ¶å¤ªå€å··å¼„ï¼Œå°‹æ‰¾è¡—é ­å¡—é´‰",
                            "ğŸ¸ æ™šä¸Šï¼šSzimpla Kert å»¢å¢Ÿé…’å§ (äº¤é€š: æ­¥è¡Œ | âš ï¸ æ™šä¸Šäººå¤šéœ€æ’éšŠ)"
                        ],
                        stay: "Three Corners Lifestyle Hotel",
                        transport: "å¸‚å€åœ°éµ/æ­¥è¡Œ (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "å¸‚å€äº¤é€š", value: "0 EUR", type: "EUR_Transport", amount: 0 },
                            { label: "é¤è²»(å«é…’æ°´)", value: "80 EUR", type: "EUR_Food", amount: 80 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    }
                ]
            },
            Vienna: {
                city: "å¥§åœ°åˆ© ç¶­ä¹Ÿç´",
                label: "ç¶­ä¹Ÿç´",
                color: "from-amber-500 to-orange-600",
                bg: "bg-amber-50",
                text: "text-amber-700",
                border: "border-amber-200",
                description: "éŸ³æ¨‚ã€çš‡å®¤èˆ‡ä¸–ç•Œéºç”¢å’–å•¡é¤¨çš„å„ªé›…ã€‚",
                days: [
                    {
                        day: "Day 5",
                        date: "2026/3/10 (äºŒ)",
                        title: "ç§»å‹•è‡³ç¶­ä¹Ÿç´ & å’–å•¡é¤¨æ–‡åŒ–",
                        imgKeyword: "RegioJet train Vienna",
                        highlights: [
                            "ğŸš‚ ç§»å‹•ï¼šå‰å¾€å¸ƒé”ä½©æ–¯è»Šç«™ï¼Œæ­ä¹˜ RegioJet ç«è»Šå‰å¾€ç¶­ä¹Ÿç´ (é è¨ˆ 3-4 å°æ™‚)",
                            "ğŸ’¡ å»ºè­°ï¼šæŠµé”å¾Œç›´æ¥è³¼è²· 72å°æ™‚äº¤é€šå¡ï¼Œç¶­ä¹Ÿç´æŸ¥ç¥¨å¾ˆå‹¤ï¼Œè²·å¡æœ€å®‰å¿ƒï¼",
                            "ä¸‹åˆï¼šè–å²è’‚èŠ¬å¤§æ•™å ‚ (å—å¡”) & æ ¼æ‹‰æœ¬å¤§è¡—æ¼«æ­¥",
                            "â˜•ï¸ ä¸‹åˆèŒ¶ï¼šä¸­å¤®å’–å•¡é¤¨ CafÃ© Central (âš ï¸ éœ€ç¾å ´æ’éšŠ)",
                            "ğŸœ æ™šé¤ï¼š**Ra'mien** (æ³°å¼/ä¸­å¼å¤§ç¢—éºµ)"
                        ],
                        stay: "Premier Inn Wien City Hauptbahnhof",
                        transport: "RegioJet ç«è»Š + åœ°éµ",
                        costs: [
                            { label: "RegioJet(2äºº)", value: "40 EUR", type: "EUR_Transport", amount: 40 },
                            { label: "72häº¤é€šå¡(2äºº)", value: "35 EUR", type: "EUR_Transport", amount: 35 },
                            { label: "ä½å®¿ (3æ™šç¸½è¨ˆ)", value: "11,373", type: "TWD_Hotel", amount: 11373 },
                            { label: "é¤è²»", value: "70 EUR", type: "EUR_Food", amount: 70 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 6",
                        date: "2026/3/11 (ä¸‰)",
                        title: "çš‡å®®èŠ±åœ’æ¼«éŠèˆ‡çµ•ç¾åœ–æ›¸é¤¨",
                        imgKeyword: "Austrian National Library State Hall",
                        highlights: [
                            "ğŸ‘‘ ä¸Šåˆï¼šç¾æ³‰å®® (SchÃ¶nbrunn) - åƒè§€å…è²»å¾ŒèŠ±åœ’èˆ‡æµ·ç¥å™´æ³‰ (ä¸é€²å®®æ®¿)",
                            "ğŸ’¡ åˆé¤è¼•é£Ÿï¼š**Billa / Spar** è¶…å¸‚çš„ **HeiÃŸe Theke** (ç†±é£Ÿå€)",
                            "ğŸ“š ä¸‹åˆï¼šå¥§åœ°åˆ©åœ‹å®¶åœ–æ›¸é¤¨ (State Hall) (ğŸŸï¸ å…¥å…§åƒè§€ä¸–ç•Œæœ€ç¾åœ–æ›¸é¤¨)",
                            "ğŸµ æ™šä¸Šï¼šç¶­ä¹Ÿç´åœ‹å®¶æ­ŒåŠ‡é™¢/é‡‘è‰²å¤§å»³ (å¤–è§€æ‹ç…§)",
                            "ğŸ“ äº¤é€šå‚™è¨»ï¼šä½¿ç”¨äº¤é€šå¡æ­ä¹˜åœ°éµ U4 ç·šå‰å¾€ç¾æ³‰å®®"
                        ],
                        stay: "Premier Inn Wien City Hauptbahnhof",
                        transport: "å¸‚å€äº¤é€š (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "å¸‚å€äº¤é€š", value: "0 EUR", type: "EUR_Transport", amount: 0 },
                            { label: "åœ–æ›¸é¤¨é–€ç¥¨(2äºº)", value: "20 EUR", type: "EUR_Activity", amount: 20 },
                            { label: "é¤è²»", value: "60 EUR", type: "EUR_Food", amount: 60 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 7",
                        date: "2026/3/12 (å››)",
                        title: "ç¾æ™¯å®®èŠ±åœ’èˆ‡æ‘©å¤©è¼ªæµªæ¼«",
                        imgKeyword: "Prater park Vienna",
                        highlights: [
                            "ğŸ–¼ ä¸Šåˆï¼šç¾æ™¯å®® Belvedere (åƒè§€å…è²»èŠ±åœ’ï¼Œçœ‹å¤–è§€)",
                            "ğŸ½ï¸ å¿…åƒåˆé¤ï¼šFiglmÃ¼ller ç‚¸è±¬æ’ (âš ï¸ æå‰3-4é€±é è¨‚)",
                            "ğŸ¡ æµªæ¼«æ¨è–¦ï¼šæ™®æ‹‰ç‰¹éŠæ¨‚åœ’ç™¾å¹´æ‘©å¤©è¼ª (ğŸŸï¸ ç¾å ´è³¼ç¥¨ â‚¬13.5)",
                            "æ™šé¤ï¼šNordsee æµ·é®®å¿«é¤"
                        ],
                        stay: "Premier Inn Wien City Hauptbahnhof",
                        transport: "åœ°éµ/é›»è»Š (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "æ‘©å¤©è¼ª", value: "27 EUR", type: "EUR_Activity", amount: 27 },
                            { label: "å¸‚å€äº¤é€š", value: "0 EUR", type: "EUR_Transport", amount: 0 },
                            { label: "é¤è²»", value: "80 EUR", type: "EUR_Food", amount: 80 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    }
                ]
            },
            LakeDistrict: {
                city: "å¥§åœ°åˆ© æ¹–å€",
                label: "æ¹–å€ & æº«æ³‰",
                color: "from-emerald-500 to-teal-600",
                bg: "bg-emerald-50",
                text: "text-emerald-700",
                border: "border-emerald-200",
                description: "çœŸå–„ç¾çš„å±±æ°´ç•«ï¼Œæ³•è˜­èŒ²ç´„ç‘Ÿå¤«çš‡å¸çš„é¿æš‘å‹åœ°ã€‚",
                days: [
                    {
                        day: "Day 8",
                        date: "2026/3/13 (äº”)",
                        title: "ç§»å‹•è‡³æº«æ³‰å°é® å·´å¾·ä¼Šèˆ",
                        imgKeyword: "Bad Ischl Austria",
                        highlights: [
                            "ç§»å‹•æ—¥ï¼šå‰å¾€èŒœèŒœå…¬ä¸»è¨‚å©šçš„å°é® - å·´å¾·ä¼Šèˆ",
                            "äº¤é€šç´°ç¯€ï¼šç¶­ä¹Ÿç´ç¸½ç«™æ­ Railjet åˆ° Attnang-Puchheimï¼Œè½‰ REX å€é–“è»Š",
                            "ä¸‹åˆï¼šæ¼«æ­¥ç‰¹å‹æ©æ²³ç•”ï¼Œäº«å—å¯§éœ",
                            "â˜•ï¸ ä¸‹åˆèŒ¶ï¼šCafÃ© Zauner (ç¾å ´å€™ä½)",
                            "æ™šé¤ï¼šè¶…å¸‚æ¡è²· + æ³¡éºµå¤§é¤ (å…¬å¯“æœ‰å»šæˆ¿æ©Ÿç‡é«˜)"
                        ],
                        stay: "Im Kurpark (å·´å¾·ä¼Šèˆ)",
                        transport: "Ã–BB Railjet + REX (ç«è»Šè½‰ä¹˜)",
                        costs: [
                            { label: "è·¨åŸå¸‚ç«è»Š", value: "60 EUR", type: "EUR_Transport", amount: 60 },
                            { label: "ä½å®¿ (2æ™šç¸½è¨ˆ)", value: "8,521", type: "TWD_Hotel", amount: 8521 },
                            { label: "é¤è²»(è¶…å¸‚+åˆèŒ¶)", value: "50 EUR", type: "EUR_Food", amount: 50 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 9",
                        date: "2026/3/14 (å…­)",
                        title: "æ²ƒçˆ¾å¤«å²¡æ¹–èˆ‡ç™»å±±ç«è»Š",
                        imgKeyword: "Schafbergbahn train",
                        highlights: [
                            "ğŸšŒ äº¤é€šï¼šæ­ä¹˜ Postbus 546 å‰å¾€ St. Wolfgang",
                            "ğŸš‚ å¿…å»ï¼šå¤å¤«å ¡ç™»å±±ç«è»Š (âš ï¸ 3æœˆè¦–å¤©æ°£ç‡Ÿé‹ï¼Œè‹¥åœé§›æ”¹éŠèˆ¹)",
                            "å‚™æ¡ˆï¼šæ²ƒçˆ¾å¤«å²¡æ¹–éŠèˆ¹ (ç¾å ´è³¼ç¥¨)",
                            "åˆé¤ï¼šæ¹–ç•”é¤å»³"
                        ],
                        stay: "Im Kurpark (å·´å¾·ä¼Šèˆ)",
                        transport: "Postbus 546 å¾€è¿”",
                        costs: [
                            { label: "å€åŸŸå…¬è»Š", value: "12 EUR", type: "EUR_Transport", amount: 12 },
                            { label: "ç™»å±±ç«è»Š/èˆ¹", value: "52 EUR", type: "EUR_Activity", amount: 52 },
                            { label: "é¤è²»", value: "70 EUR", type: "EUR_Food", amount: 70 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 10",
                        date: "2026/3/15 (æ—¥)",
                        title: "å“ˆä¿®å¡”ç‰¹èˆ‡æˆˆç´¹æ¹–",
                        imgKeyword: "Hallstatt lake morning",
                        highlights: [
                            "ğŸšŒ äº¤é€šï¼šæ­ä¹˜ Postbus 542 è½‰ 543 è‡³ Hallstatt",
                            "ğŸŒ² ç§˜å¢ƒï¼šæˆˆç´¹æ¹– Gosausee (âš ï¸ å»ºè­°æŸ¥å¥½å›ç¨‹æ™‚åˆ»)",
                            "å‚æ™šï¼šäº«å—åœ˜å®¢æ•£å»å¾Œçš„å¯§éœå“ˆä¿®å¡”ç‰¹",
                            "æ™šé¤ï¼šç°¡å–®åƒæˆ–è‡ªå‚™è¼•é£Ÿ (æ™¯å€é¤å»³è²´ï¼Œå¯è‡ªå‚™æ³¡éºµ)"
                        ],
                        stay: "Heritage Hotel Hallstatt (é¢æ¹–)",
                        transport: "Postbus 542/543",
                        costs: [
                            { label: "å€åŸŸå…¬è»Š", value: "20 EUR", type: "EUR_Transport", amount: 20 },
                            { label: "ä½å®¿ (1æ™š)", value: "10,124", type: "TWD_Hotel", amount: 10124 },
                            { label: "é¤è²»", value: "60 EUR", type: "EUR_Food", amount: 60 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    }
                ]
            },
            CKTown: {
                city: "æ·å…‹ CKå°é®",
                label: "CK å°é®",
                color: "from-orange-700 to-red-800",
                bg: "bg-orange-50",
                text: "text-orange-900",
                border: "border-orange-200",
                description: "åº«å€«æ´›å¤« (ÄŒeskÃ½ Krumlov)ï¼Œè¢«æ²³ç£åŒ…åœçš„ä¸­ä¸–ç´€ç«¥è©±ã€‚",
                days: [
                    {
                        day: "Day 11",
                        date: "2026/3/16 (ä¸€)",
                        title: "å“ˆä¿®å¡”ç‰¹æ™¨å…‰ & ç§»å‹•è‡³CKå°é®",
                        imgKeyword: "Cesky Krumlov aerial",
                        highlights: [
                            "ğŸŒ… çµ•æ™¯ï¼šå“ˆä¿®å¡”ç‰¹æ™¨éœ§",
                            "â­ï¸ å¿…å»ï¼šå“ˆä¿®å¡”ç‰¹å¤©ç©ºæ­¥é“ Skywalk (å»ºè­°ç¾å ´è³¼ç¥¨)",
                            "ğŸ’€ æ–‡åŒ–é«”é©—ï¼šäººéª¨æ•™å ‚ Bone House",
                            "ä¸­åˆï¼šCK Shuttle (âš ï¸ å‹™å¿…æå‰é è¨‚)",
                            "ğŸ½ï¸ å¿…åƒæ™šé¤ï¼šåœ°çª–é¤å»³ KrÄma v Å atlavskÃ© ulici (âš ï¸ æå‰ Email é è¨‚)",
                            "ğŸ’¡ å°è²»ï¼šæ·å…‹ç¿’æ…£çµ¦ 10% å°è²»ï¼Œé›¢å·´å£«ç«™æ­¥è¡Œç´„ 13 åˆ†é˜ï¼Œå»ºè­°è¼•è£æˆ–é ç´„æ¥é§"
                        ],
                        stay: "Pension Nostalgie (èˆŠåŸå€æ°‘å®¿)",
                        transport: "CK Shuttle (å…±ä¹˜å°ˆè»Š)",
                        costs: [
                            { label: "CK Shuttle", value: "156 EUR", type: "EUR_Transport", amount: 156 },
                            { label: "çºœè»Š/é–€ç¥¨", value: "45 EUR", type: "EUR_Activity", amount: 45 },
                            { label: "ä½å®¿ (1æ™š)", value: "2,689", type: "TWD_Hotel", amount: 2689 },
                            { label: "é¤è²»(åœ°çª–é¤å»³)", value: "70 EUR", type: "EUR_Food", amount: 70 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 12",
                        date: "2026/3/17 (äºŒ)",
                        title: "åŸå ¡å·¡ç¦® & ç§»å‹•è‡³å¸ƒæ‹‰æ ¼",
                        imgKeyword: "Prague Old Town Square",
                        highlights: [
                            "ä¸Šåˆï¼šCK åŸå ¡å½©ç¹ªå¡” (ğŸŸï¸ ç¾å ´è³¼ç¥¨ç™»å¡”)",
                            "ä¸‹åˆï¼šç§»å‹•è‡³å¸ƒæ‹‰æ ¼ (äº¤é€š: FlixBus å·´å£« | âš ï¸ æå‰è¨‚ç¥¨)",
                            "å°åƒï¼šè·¯é‚Šè²·ç†±é¨°é¨°è‚‰æ¡‚æ² (TrdelnÃ­k)",
                            "ğŸœ äºæ´²èƒƒï¼š**Bistro Topinka** æˆ–ç•¶åœ°è¶Šå—å°é¤¨"
                        ],
                        stay: "The Viaduct - Suites & More (å«æ—©é¤)",
                        transport: "CK â†’ å¸ƒæ‹‰æ ¼ (FlixBus)",
                        costs: [
                            { label: "è·¨åŸå·´å£«", value: "30 EUR", type: "EUR_Transport", amount: 30 },
                            { label: "å½©ç¹ªå¡”é–€ç¥¨", value: "8 EUR", type: "EUR_Activity", amount: 8 },
                            { label: "ä½å®¿ (3æ™šç¸½è¨ˆ)", value: "16,893", type: "TWD_Hotel", amount: 16893 },
                            { label: "é¤è²»", value: "50 EUR", type: "EUR_Food", amount: 50 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    }
                ]
            },
            Prague: {
                city: "æ·å…‹ å¸ƒæ‹‰æ ¼",
                label: "å¸ƒæ‹‰æ ¼ & å›ç¨‹",
                color: "from-purple-600 to-indigo-700",
                bg: "bg-purple-50",
                text: "text-purple-800",
                border: "border-purple-200",
                description: "åƒå¡”ä¹‹åŸçš„ç¥ç¥•ï¼Œèˆ‡ç¾å¥½çš„èœœæœˆå¥é»ã€‚",
                days: [
                    {
                        day: "Day 13",
                        date: "2026/3/18 (ä¸‰)",
                        title: "åŸå ¡å€å…è²»æ¼«éŠ & æŸ¥ç†å¤§æ©‹",
                        imgKeyword: "Charles Bridge Prague",
                        highlights: [
                            "ğŸ’¡ å»ºè­°ï¼šè³¼è²· 72å°æ™‚äº¤é€šå¡ (ç´„13æ­/äºº)ï¼Œå¯éš¨ä¸Šéš¨ä¸‹é›»è»Šèˆ‡çºœè»Šï¼Œçˆ¬åŸå ¡å±±ä¸è…¿è»Ÿï¼",
                            "ğŸ° ä¸Šåˆï¼šå¸ƒæ‹‰æ ¼åŸå ¡ (é€²å…¥åŸå ¡å€å…è²»ï¼Œåƒ…åœ¨å¤–éƒ¨åº­é™¢åƒè§€æ‹ç…§)",
                            "æ¼«æ­¥ï¼šå¿…èµ°æŸ¥ç†å¤§æ©‹ (Charles Bridge) (âš ï¸ å°å¿ƒæ‰’æ‰‹)",
                            "æ”¾é¬†ï¼šæ©‹ä¸‹åº·å¸•å³¶èˆ‡åˆ—å„‚ç‰†å¡—é´‰",
                            "ğŸœ å¿…åƒè¼•é£Ÿï¼š**Remember Vietnamese** (å¸ƒæ‹‰æ ¼è¶Šå—æ²³ç²‰è¶…é“åœ°ï¼)"
                        ],
                        stay: "The Viaduct - Suites & More (å«æ—©é¤)",
                        transport: "åœ°éµ/é›»è»Š/æ­¥è¡Œ (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "72häº¤é€šå¡(2äºº)", value: "26 EUR", type: "EUR_Transport", amount: 26 },
                            { label: "é–€ç¥¨", value: "0 EUR", type: "EUR_Activity", amount: 0 },
                            { label: "é¤è²»", value: "50 EUR", type: "EUR_Food", amount: 50 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 14",
                        date: "2026/3/19 (å››)",
                        title: "ä½©ç‰¹ä»»å±±èˆ‡èˆŠåŸå€",
                        imgKeyword: "Prague rooftop view",
                        highlights: [
                            "ä¸Šåˆï¼šä½©ç‰¹ä»»å±±çºœè»Š (ğŸŸï¸ ä½¿ç”¨äº¤é€šå¡å…è²»æ­ä¹˜ï¼Œå¯ä¿¯ç°å¸ƒæ‹‰æ ¼å…¨æ™¯)",
                            "ä¸‹åˆï¼šæ¼«æ­¥èˆŠåŸå»£å ´ (Old Town Square) å¤©æ–‡é˜",
                            "ğŸ½ èœœæœˆæ™šé¤ï¼šé ç´„æ™¯è§€é¤å»³ (âš ï¸ å»ºè­°æå‰1å€‹æœˆè¨‚ä½ï¼Œé€™é¤åƒå¥½é»ï¼)",
                            "ğŸ’¡ åˆé¤è¼•é£Ÿï¼š**Sisters Bistro** (æ·å…‹å‚³çµ±é–‹é¢ä¸‰æ˜æ²» ChlebÃ­Äky)"
                        ],
                        stay: "The Viaduct - Suites & More (å«æ—©é¤)",
                        transport: "çºœè»Š/åœ°éµ (ä½¿ç”¨äº¤é€šå¡)",
                        costs: [
                            { label: "çºœè»Š(å«åœ¨å¡å…§)", value: "0 EUR", type: "EUR_Transport", amount: 0 },
                            { label: "é¤è²»(å«å¤§é¤)", value: "90 EUR", type: "EUR_Food", amount: 90 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 15",
                        date: "2026/3/20 (äº”)",
                        title: "å‘Šåˆ¥å¸ƒæ‹‰æ ¼ & å‰å¾€æ©Ÿå ´",
                        imgKeyword: "Prague charming cobblestone street old town historic buildings", 
                        highlights: [
                            "æœ€å¾Œæ¡è²·ï¼šè ä¸¹å¦®é¦™æ°›çš‚ã€è”“è²è˜¿ã€Koh-i-noor è‰²é‰›ç­†",
                            "ä¸‹åˆï¼šå‰å¾€å¸ƒæ‹‰æ ¼æ©Ÿå ´ (EK140 14:45 èµ·é£›)",
                            "æ­æ©Ÿï¼šå¸ƒæ‹‰æ ¼ â†’ æœæ‹œ (è½‰æ©Ÿ)"
                        ],
                        stay: "æ©Ÿä¸Šä¼‘æ¯",
                        transport: "å‰å¾€æ©Ÿå ´ & é£›æ©Ÿ",
                        costs: [
                            { label: "æ©Ÿç¥¨", value: "å·²å«", type: "Included", amount: 0 },
                            { label: "æ©Ÿå ´äº¤é€š", value: "25 EUR", type: "EUR_Transport", amount: 25 },
                            { label: "é¤è²»", value: "20 EUR", type: "EUR_Food", amount: 20 },
                            { label: "å°è²»é›œæ”¯", value: "10 EUR", type: "EUR_Tips", amount: 10 }
                        ]
                    },
                    {
                        day: "Day 16",
                        date: "2026/3/21 (å…­)",
                        title: "æŠµé”æº«æš–çš„å®¶",
                        imgKeyword: "cute calico cat white chest brown ears sitting waiting at home sweet", 
                        highlights: [
                            "03:40 æœæ‹œè½‰æ©Ÿ (EK366)",
                            "15:35 æŠµé”å°åŒ—",
                            "å¹³å®‰çµæŸ 16 å¤©æµªæ¼«èœœæœˆä¹‹æ—…",
                            "ğŸˆ è²“å’ªåœ¨ç­‰é–€ï¼šæ­¡è¿å›å®¶ï¼"
                        ],
                        stay: "æº«æš–çš„å®¶",
                        transport: "æ©Ÿå ´æ¥é€/æ·é‹",
                        costs: [
                            { label: "å›æ†¶", value: "ç„¡åƒ¹", type: "Priceless", amount: 0 }
                        ]
                    }
                ]
            }
        };

        const ItineraryApp = () => {
            const [activeTab, setActiveTab] = useState('Departure'); 
            const [showBudget, setShowBudget] = useState(false);
            const [showBudgetDetail, setShowBudgetDetail] = useState(false);
            const [isEditMode, setIsEditMode] = useState(false);
            const [itineraryData, setItineraryData] = useState(defaultItineraryData);
            const [totalBudget, setTotalBudget] = useState(240000);
            
            // æ°£è±¡ç‹€æ…‹
            const [weather, setWeather] = useState(null);
            const [loadingWeather, setLoadingWeather] = useState(false);
            const [copySuccess, setCopySuccess] = useState(false);
            const [tripId, setTripId] = useState(null);

            // åŒ¯ç‡ç‹€æ…‹
            const [exchangeRate, setExchangeRate] = useState(35); // é è¨­ 35
            const [loadingRate, setLoadingRate] = useState(false);

            // --- 1. åƒ…ä¿ç•™æœ¬æ©Ÿè®€å– ---
            useEffect(() => {
                const init = async () => {
                    // ç”Ÿæˆä¸€å€‹éš¨æ©Ÿ ID åƒ…ä¾›æœ¬åœ°è­˜åˆ¥ç”¨
                    let currentTripId = localStorage.getItem('my_trip_id');
                    if (!currentTripId) {
                        currentTripId = crypto.randomUUID().substring(0, 8);
                        localStorage.setItem('my_trip_id', currentTripId);
                    }
                    setTripId(currentTripId);

                    // å˜—è©¦è®€å–æœ¬åœ°å‚™ä»½è³‡æ–™
                    const localData = localStorage.getItem(`itinerary_${currentTripId}`);
                    const localBudget = localStorage.getItem(`budget_${currentTripId}`);
                    
                    if (localData) {
                        try {
                            setItineraryData(JSON.parse(localData));
                        } catch(e) { console.error("Local data parse error", e); }
                    }
                    if (localBudget) {
                        setTotalBudget(parseInt(localBudget));
                    }
                };
                init();
            }, []);

            // --- 2. åƒ…ä¿ç•™æœ¬æ©Ÿå„²å­˜ (ç§»é™¤é›²ç«¯å¯«å…¥) ---
            const debouncedSave = useMemo(() => {
                // é€™è£¡åªè² è²¬å­˜ Local Storage
                return (data, budget) => {
                    if (tripId) {
                        localStorage.setItem(`itinerary_${tripId}`, JSON.stringify(data));
                        localStorage.setItem(`budget_${tripId}`, budget.toString());
                    }
                };
            }, [tripId]);

            useEffect(() => {
                if (tripId) {
                    debouncedSave(itineraryData, totalBudget);
                }
            }, [itineraryData, totalBudget, debouncedSave, tripId]);


            // --- æ°£è±¡ API æŸ¥è©¢ ---
            useEffect(() => {
                const fetchWeather = async () => {
                    const coords = cityCoordinates[activeTab];
                    if (!coords || coords.avgTemp === 'N/A') {
                        setWeather(null);
                        return;
                    }
                    
                    setLoadingWeather(true);
                    try {
                        const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current_weather=true`);
                        const data = await response.json();
                        setWeather({
                            temp: data.current_weather.temperature,
                            code: data.current_weather.weathercode,
                            avg: coords.avgTemp
                        });
                    } catch (error) {
                        console.error("Weather fetch failed", error);
                        setWeather(null);
                    } finally {
                        setLoadingWeather(false);
                    }
                };
                
                fetchWeather();
            }, [activeTab]);

            // --- åŒ¯ç‡ API æŸ¥è©¢ ---
            useEffect(() => {
                const fetchExchangeRate = async () => {
                    setLoadingRate(true);
                    try {
                        const response = await fetch('https://api.exchangerate-api.com/v4/latest/EUR');
                        const data = await response.json();
                        if (data && data.rates && data.rates.TWD) {
                            setExchangeRate(data.rates.TWD);
                        }
                    } catch (error) {
                        console.error("Exchange rate fetch failed, using default 35", error);
                    } finally {
                        setLoadingRate(false);
                    }
                };
                fetchExchangeRate();
            }, []);

            // --- è²¡å‹™è¨ˆç®—é‚è¼¯ (ä½¿ç”¨å³æ™‚åŒ¯ç‡) ---
            const financialSummary = useMemo(() => {
                let categories = { flight: 0, hotel: 0, transport: 0, food: 0, activity: 0, tips: 0, prep: 0 };
                
                Object.values(itineraryData).forEach(city => {
                    city.days.forEach(day => {
                        day.costs.forEach(cost => {
                            const amount = Number(cost.amount) || 0;
                            if (cost.type === 'TWD_Flight') categories.flight += amount * 2; 
                            else if (cost.type === 'TWD_Hotel') categories.hotel += amount; 
                            else if (cost.type === 'EUR_Transport') categories.transport += (amount * exchangeRate);
                            else if (cost.type === 'EUR_Food') categories.food += (amount * exchangeRate);
                            else if (cost.type === 'EUR_Activity') categories.activity += (amount * exchangeRate);
                            else if (cost.type === 'EUR_Tips') categories.tips += (amount * exchangeRate);
                            else if (cost.type === 'TWD_Prep') categories.prep += amount; 
                        });
                    });
                });

                const totalExpenses = Object.values(categories).reduce((a, b) => a + b, 0);
                const remaining = totalBudget - totalExpenses;

                return { categories, total: totalExpenses, remaining };
            }, [itineraryData, totalBudget, exchangeRate]);

            const formatMoney = (amount) => {
                if (showBudget) return `NT$ ${Math.round(amount).toLocaleString()}`;
                return "NT$ ****";
            };

            // --- åŠŸèƒ½èˆ‡ç·¨è¼¯ handlers ---
            const handleShare = () => {
                navigator.clipboard.writeText(window.location.href);
                setCopySuccess(true);
                setTimeout(() => setCopySuccess(false), 2000);
            };
            
            const handleExport = () => {
                const dataStr = JSON.stringify(itineraryData);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = 'honeymoon_itinerary.json';
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            };

            const handleImport = () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/json';
                input.onchange = e => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.readAsText(file, 'UTF-8');
                    reader.onload = readerEvent => {
                        const content = readerEvent.target.result;
                        try {
                            setItineraryData(JSON.parse(content));
                            alert("åŒ¯å…¥æˆåŠŸï¼");
                        } catch (err) {
                            alert("åŒ¯å…¥å¤±æ•—ï¼Œæª”æ¡ˆæ ¼å¼éŒ¯èª¤");
                        }
                    }
                }
                input.click();
            };

            const handleCityChange = (cityKey, field, value) => {
                setItineraryData(prev => ({ ...prev, [cityKey]: { ...prev[cityKey], [field]: value } }));
            };
            const handleDayChange = (cityKey, dayIndex, field, value) => {
                const newData = { ...itineraryData };
                newData[cityKey].days[dayIndex][field] = value;
                setItineraryData(newData);
            };
            const handleHighlightChange = (cityKey, dayIndex, hIndex, value) => {
                const newData = { ...itineraryData };
                newData[cityKey].days[dayIndex].highlights[hIndex] = value;
                setItineraryData(newData);
            };
            const addHighlight = (cityKey, dayIndex) => {
                const newData = { ...itineraryData };
                newData[cityKey].days[dayIndex].highlights.push("æ–°è¡Œç¨‹...");
                setItineraryData(newData);
            };
            const removeHighlight = (cityKey, dayIndex, hIndex) => {
                const newData = { ...itineraryData };
                newData[cityKey].days[dayIndex].highlights.splice(hIndex, 1);
                setItineraryData(newData);
            };
            const handleCostChange = (cityKey, dayIndex, cIndex, field, value) => {
                const newData = { ...itineraryData };
                newData[cityKey].days[dayIndex].costs[cIndex][field] = value;
                setItineraryData(newData);
            };
            const addNewDay = (cityKey) => {
                const newData = { ...itineraryData };
                newData[cityKey].days.push({
                    day: `Day New`, date: "æ—¥æœŸ", title: "æ–°çš„ä¸€å¤©", imgKeyword: "travel bag", highlights: ["æ–°å¢è¡Œç¨‹é»..."], stay: "ä½å®¿åœ°é»", transport: "äº¤é€šæ–¹å¼", costs: [{ label: "é ä¼°èŠ±è²»", value: "0", type: "EUR_Food", amount: 0 }]
                });
                setItineraryData(newData);
            };
            const removeDay = (cityKey, dayIndex) => {
                if(!confirm("ç¢ºå®šè¦åˆªé™¤é€™å¤©è¡Œç¨‹å—ï¼Ÿ")) return;
                const newData = { ...itineraryData };
                newData[cityKey].days.splice(dayIndex, 1);
                setItineraryData(newData);
            };
            const resetData = () => {
                if(confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰è³‡æ–™å—ï¼Ÿ")) {
                    setItineraryData(defaultItineraryData);
                    setTotalBudget(240000);
                }
            };

            const tabs = Object.keys(itineraryData);
            const currentData = itineraryData[activeTab];

            return (
                <div className="min-h-screen pb-24 relative">
                    {/* Header Image Area */}
                    <div className="relative h-80 md:h-[420px] bg-slate-800 overflow-hidden shadow-lg transition-all duration-300">
                        <img 
                            src="https://image.pollinations.ai/prompt/romantic%20central%20europe%20travel%20collage%20budapest%20vienna%20prague?width=1200&height=600&nologo=true" 
                            alt="Header" 
                            className="w-full h-full object-cover opacity-50"
                        />
                        <div className="absolute inset-0 bg-gradient-to-t from-slate-900 to-transparent"></div>
                        <div className="absolute bottom-0 left-0 p-6 md:p-10 text-white w-full">
                            <div className="flex flex-col md:flex-row md:justify-between md:items-end gap-4">
                                <div>
                                    <div className="flex items-center gap-2 text-rose-300 mb-2 font-medium tracking-wide">
                                        <Icon name="heart" size={20} className="fill-current" />
                                        <span>2026 èœœæœˆä¹‹æ—…</span>
                                        <span className="flex items-center gap-1 text-xs text-slate-400 ml-2 border border-slate-600 rounded px-2">
                                            <Icon name="offline" size={12} />
                                            æœ¬æ©Ÿç‰ˆ
                                        </span>
                                    </div>
                                    <h1 className="text-2xl md:text-4xl whitespace-nowrap font-bold mb-2 leading-tight">ä¸­æ­ä¸‰åœ‹ â€¢ æµªæ¼«è¡Œæ—…</h1>
                                    <div className="flex flex-wrap gap-2 items-center mb-4">
                                        <p className="text-slate-200 text-sm md:text-lg max-w-2xl opacity-90">
                                            å°åŒ— (é˜¿è¯é…‹) <Icon name="arrowRight" size={14} className="inline mx-1"/> 
                                            åŒˆç‰™åˆ© <Icon name="arrowRight" size={14} className="inline mx-1"/> 
                                            å¥§åœ°åˆ© <Icon name="arrowRight" size={14} className="inline mx-1"/> 
                                            æ·å…‹
                                        </p>
                                        <button 
                                            onClick={handleShare}
                                            className="ml-2 flex items-center gap-1 bg-white/20 hover:bg-white/30 text-white text-xs px-3 py-1 rounded-full transition-colors backdrop-blur-sm"
                                        >
                                            <Icon name="share" size={12} />
                                            {copySuccess ? "å·²è¤‡è£½é€£çµï¼" : "åˆ†äº«è¡Œç¨‹"}
                                        </button>
                                        {/* å‚™ä»½æŒ‰éˆ•å€åŸŸ */}
                                        <button onClick={handleExport} className="flex items-center gap-1 bg-white/20 hover:bg-white/30 text-white text-xs px-3 py-1 rounded-full transition-colors backdrop-blur-sm">
                                            <Icon name="save" size={12} /> å‚™ä»½ä¸‹è¼‰
                                        </button>
                                        <button onClick={handleImport} className="flex items-center gap-1 bg-white/20 hover:bg-white/30 text-white text-xs px-3 py-1 rounded-full transition-colors backdrop-blur-sm">
                                            åŒ¯å…¥é‚„åŸ
                                        </button>
                                    </div>
                                    
                                    {/* å¤©æ°£å°å·¥å…· */}
                                    {weather && (
                                        <div className="inline-flex items-center gap-3 bg-white/10 backdrop-blur-md rounded-full px-4 py-2 border border-white/20 animate-fade-in mb-2 md:mb-0">
                                            <Icon name="sun" size={20} className="text-yellow-300" />
                                            <div>
                                                <div className="text-xs text-slate-300 uppercase">Weather in {cityCoordinates[activeTab].name}</div>
                                                <div className="font-bold flex items-center gap-2">
                                                    <span>{weather.temp}Â°C (å³æ™‚)</span>
                                                    <span className="w-px h-3 bg-white/30"></span>
                                                    <span className="text-xs font-normal opacity-80">3æœˆå‡æº«: {weather.avg}</span>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* å³æ™‚åŒ¯ç‡å°å·¥å…· (æ–°åŠŸèƒ½) */}
                                    <div className="inline-flex items-center gap-3 bg-emerald-500/20 backdrop-blur-md rounded-full px-4 py-2 border border-emerald-400/30 animate-fade-in ml-0 md:ml-2">
                                        <Icon name="euro" size={20} className="text-emerald-300" />
                                        <div>
                                            <div className="text-xs text-emerald-100 uppercase">Live Exchange Rate</div>
                                            <div className="font-bold flex items-center gap-2 text-white">
                                                <span>1 EUR â‰ˆ {exchangeRate.toFixed(2)} TWD</span>
                                                {loadingRate && <Icon name="refresh" size={12} className="animate-spin" />}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* é ç®—å„€è¡¨æ¿ (å¯å±•é–‹) */}
                                <div className="glass-panel rounded-xl p-4 min-w-[300px] transition-all duration-300">
                                    <div className="flex justify-between items-center mb-2">
                                        <div className="text-xs text-slate-300 uppercase tracking-wider font-semibold">è²¡å‹™é ä¼° (å³æ™‚åŒ¯ç‡æ›ç®—)</div>
                                        <div className="flex gap-2">
                                            <button onClick={() => setShowBudgetDetail(!showBudgetDetail)} className="text-slate-300 hover:text-white" title="æŸ¥çœ‹åˆ†é¡æ˜ç´°">
                                                <Icon name="chevronDown" size={16} className={`transform transition-transform ${showBudgetDetail ? 'rotate-180' : ''}`} />
                                            </button>
                                            <button onClick={() => setShowBudget(!showBudget)} className="text-slate-300 hover:text-white" title={showBudget ? "éš±è—é‡‘é¡" : "é¡¯ç¤ºé‡‘é¡"}>
                                                <Icon name={showBudget ? "eye" : "eyeOff"} size={16} />
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div className="space-y-1">
                                        <div className="flex justify-between items-end">
                                            <span className="text-sm text-slate-300">ç¸½é ç®—</span>
                                            {isEditMode ? (
                                                <input type="number" value={totalBudget} onChange={(e) => setTotalBudget(Number(e.target.value))} className="w-24 text-right bg-white/20 text-white rounded px-1" />
                                            ) : <span className="text-lg font-bold font-mono text-white">{formatMoney(totalBudget)}</span>}
                                        </div>
                                        
                                        {/* åˆ†é¡æ˜ç´° (å±•é–‹æ™‚é¡¯ç¤º) */}
                                        {showBudgetDetail && (
                                            <div className="my-3 pt-2 border-t border-white/10 space-y-1 text-xs">
                                                <div className="flex justify-between text-slate-300"><span>ğŸ“‹ è¡Œå‰æº–å‚™</span><span>{formatMoney(financialSummary.categories.prep)}</span></div>
                                                <div className="flex justify-between text-slate-300"><span>âœˆï¸ æ©Ÿç¥¨</span><span>{formatMoney(financialSummary.categories.flight)}</span></div>
                                                <div className="flex justify-between text-slate-300"><span>ğŸ¨ ä½å®¿</span><span>{formatMoney(financialSummary.categories.hotel)}</span></div>
                                                <div className="flex justify-between text-slate-300"><span>ğŸšŒ äº¤é€š</span><span>{formatMoney(financialSummary.categories.transport)}</span></div>
                                                <div className="flex justify-between text-slate-300"><span>ğŸ½ï¸ é¤é£²</span><span>{formatMoney(financialSummary.categories.food)}</span></div>
                                                <div className="flex justify-between text-slate-300"><span>ğŸ« é–€ç¥¨</span><span>{formatMoney(financialSummary.categories.activity)}</span></div>
                                                <div className="flex justify-between text-slate-300 font-medium"><span>ğŸ’¸ å°è²»é›œæ”¯</span><span>{formatMoney(financialSummary.categories.tips)}</span></div>
                                            </div>
                                        )}

                                        <div className="h-px bg-white/20 my-2"></div>
                                        <div className="flex justify-between items-end">
                                            {/* è³¼ç‰©é ç®—é¡¯ç¤º */}
                                            <span className="text-sm text-emerald-300 font-medium flex items-center gap-1">
                                                <Icon name="shopping" size={14} />
                                                å‰©é¤˜ / è³¼ç‰©é‡‘
                                            </span>
                                            <span className="text-xl font-bold font-mono text-emerald-300">{formatMoney(financialSummary.remaining)}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Navigation Tabs */}
                    <div className="sticky top-0 z-30 bg-white shadow-sm border-b border-slate-200 overflow-x-auto hide-scrollbar">
                        <div className="max-w-4xl mx-auto px-4">
                            <div className="flex space-x-2 py-3 min-w-max">
                                {tabs.map((key) => (
                                    <button
                                        key={key}
                                        onClick={() => setActiveTab(key)}
                                        className={`
                                            px-4 py-2 rounded-full text-sm font-medium transition-all duration-300 whitespace-nowrap flex items-center gap-2
                                            ${activeTab === key 
                                                ? `bg-slate-800 text-white shadow-md transform scale-105` 
                                                : 'bg-slate-100 text-slate-600 hover:bg-slate-200 hover:text-slate-800'}
                                        `}
                                    >
                                        <Icon name={key === 'Departure' ? 'clipboard' : 'mapPin'} size={14} className={activeTab === key ? "fill-current" : ""} />
                                        {itineraryData[key].label}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="max-w-4xl mx-auto px-4 py-8">
                        
                        {/* Section Header */}
                        <div className="mb-8 animate-fade-in" key={activeTab}>
                            <div className={`inline-block px-3 py-1 rounded-md text-sm font-bold bg-gradient-to-r ${currentData.color} text-white mb-3 shadow-sm`}>
                                {isEditMode ? (
                                    <input 
                                        type="text" 
                                        value={currentData.city}
                                        onChange={(e) => handleCityChange(activeTab, 'city', e.target.value)}
                                        className="bg-transparent text-white w-full outline-none border-b border-slate-200"
                                    />
                                ) : currentData.city}
                            </div>
                            <h2 className="text-2xl md:text-3xl font-bold text-slate-800 mb-2">
                                {isEditMode ? (
                                    <textarea 
                                        value={currentData.description}
                                        onChange={(e) => handleCityChange(activeTab, 'description', e.target.value)}
                                        className="w-full bg-slate-100 p-2 rounded text-base"
                                        rows={2}
                                    />
                                ) : currentData.description}
                            </h2>
                        </div>

                        {/* Daily Cards */}
                        <div className="grid gap-8">
                            {currentData.days.map((dayData, index) => (
                                <div 
                                    key={index} 
                                    className="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden hover:shadow-lg transition-shadow duration-300 flex flex-col md:flex-row group animate-fade-in relative"
                                    style={{ animationDelay: `${index * 0.1}s` }}
                                >
                                    {isEditMode && (
                                        <button 
                                            onClick={() => removeDay(activeTab, index)}
                                            className="absolute top-2 right-2 z-20 bg-rose-500 text-white p-2 rounded-full hover:bg-rose-600 shadow-md"
                                            title="åˆªé™¤é€™ä¸€å¤©"
                                        >
                                            <Icon name="trash" size={16} />
                                        </button>
                                    )}

                                    {/* Image Section */}
                                    <div className="md:w-1/3 h-48 md:h-auto relative overflow-hidden bg-slate-200">
                                        <img 
                                            src={`https://image.pollinations.ai/prompt/travel%20photography%20${dayData.imgKeyword}?width=600&height=800&nologo=true`}
                                            alt={dayData.title}
                                            className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
                                            loading="lazy"
                                        />
                                        <div className="absolute top-0 left-0 bg-black/60 text-white px-3 py-1 rounded-br-lg text-sm font-bold backdrop-blur-sm">
                                            {isEditMode ? (
                                                <input 
                                                    value={dayData.day}
                                                    onChange={(e) => handleDayChange(activeTab, index, 'day', e.target.value)}
                                                    className="bg-transparent text-white w-16"
                                                />
                                            ) : dayData.day}
                                        </div>
                                        {isEditMode && (
                                            <div className="absolute bottom-0 left-0 w-full bg-black/70 p-2">
                                                <div className="text-xs text-slate-300 mb-1">åœ–ç‰‡é—œéµå­— (è‹±æ–‡):</div>
                                                <input 
                                                    value={dayData.imgKeyword}
                                                    onChange={(e) => handleDayChange(activeTab, index, 'imgKeyword', e.target.value)}
                                                    className="w-full text-xs bg-white/20 text-white rounded px-1"
                                                />
                                            </div>
                                        )}
                                    </div>

                                    {/* Content Section */}
                                    <div className="p-6 md:w-2/3 flex flex-col justify-between">
                                        <div>
                                            <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
                                                <Icon name="calendar" size={14} />
                                                {isEditMode ? (
                                                    <input 
                                                        value={dayData.date}
                                                        onChange={(e) => handleDayChange(activeTab, index, 'date', e.target.value)}
                                                        className="border-b border-slate-300"
                                                    />
                                                ) : <span>{dayData.date}</span>}
                                            </div>
                                            <h3 className="text-xl font-bold text-slate-800 mb-4 group-hover:text-rose-600 transition-colors">
                                                {isEditMode ? (
                                                    <input 
                                                        value={dayData.title}
                                                        onChange={(e) => handleDayChange(activeTab, index, 'title', e.target.value)}
                                                        className="w-full border-b-2 border-slate-200 focus:border-rose-400 outline-none"
                                                    />
                                                ) : dayData.title}
                                            </h3>

                                            {/* Highlights */}
                                            <div className="space-y-2 mb-6">
                                                {dayData.highlights.map((point, idx) => (
                                                    <div key={idx} className="flex items-start gap-2 text-slate-600 group/item">
                                                        <div className="mt-1.5 w-1.5 h-1.5 rounded-full bg-rose-400 flex-shrink-0"></div>
                                                        {isEditMode ? (
                                                            <div className="flex-1 flex gap-2">
                                                                <input 
                                                                    value={point}
                                                                    onChange={(e) => handleHighlightChange(activeTab, index, idx, e.target.value)}
                                                                    className="w-full border-b border-slate-200 text-sm"
                                                                />
                                                                <button onClick={() => removeHighlight(activeTab, index, idx)} className="text-slate-400 hover:text-rose-500">
                                                                    <Icon name="trash" size={14} />
                                                                </button>
                                                            </div>
                                                        ) : (
                                                            <span className="text-sm leading-relaxed">{point}</span>
                                                        )}
                                                    </div>
                                                ))}
                                                {isEditMode && (
                                                    <button 
                                                        onClick={() => addHighlight(activeTab, index)}
                                                        className="text-xs text-rose-500 flex items-center gap-1 hover:underline mt-2"
                                                    >
                                                        <Icon name="plus" size={12} /> æ–°å¢è¡Œç¨‹é»
                                                    </button>
                                                )}
                                            </div>
                                        </div>

                                        {/* Info Footer */}
                                        <div className={`mt-4 pt-4 border-t border-dashed ${currentData.border} grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm`}>
                                            
                                            {/* Hotel */}
                                            <div className="flex items-start gap-2">
                                                <div className={`p-1.5 rounded-md ${currentData.bg} ${currentData.text}`}>
                                                    <Icon name="bed" size={16} />
                                                </div>
                                                <div className="w-full">
                                                    <div className="text-xs text-slate-400 font-medium uppercase">ä½å®¿/ä¼‘æ¯</div>
                                                    {isEditMode ? (
                                                        <input 
                                                            value={dayData.stay}
                                                            onChange={(e) => handleDayChange(activeTab, index, 'stay', e.target.value)}
                                                            className="w-full border-b border-slate-200"
                                                        />
                                                    ) : <div className="font-medium text-slate-700">{dayData.stay}</div>}
                                                </div>
                                            </div>

                                            {/* Transport */}
                                            <div className="flex items-start gap-2">
                                                <div className={`p-1.5 rounded-md ${currentData.bg} ${currentData.text}`}>
                                                    {dayData.transport.includes('é£›æ©Ÿ') || dayData.transport.includes('é˜¿è¯é…‹') ? <Icon name="plane" size={16} /> : <Icon name="train" size={16} />}
                                                </div>
                                                <div className="w-full">
                                                    <div className="text-xs text-slate-400 font-medium uppercase">äº¤é€šç§»å‹•</div>
                                                    {isEditMode ? (
                                                        <input 
                                                            value={dayData.transport}
                                                            onChange={(e) => handleDayChange(activeTab, index, 'transport', e.target.value)}
                                                            className="w-full border-b border-slate-200"
                                                        />
                                                    ) : <div className="font-medium text-slate-700">{dayData.transport}</div>}
                                                </div>
                                            </div>

                                            {/* Cost */}
                                            <div className="col-span-1 sm:col-span-2 flex items-start gap-2">
                                                <div className={`p-1.5 rounded-md ${currentData.bg} ${currentData.text}`}>
                                                    <Icon name="euro" size={16} />
                                                </div>
                                                <div className="flex-1">
                                                    <div className="text-xs text-slate-400 font-medium uppercase">é ä¼°èŠ±è²» (é‡‘é¡è«‹å¡«æ•¸å­—)</div>
                                                    <div className="flex flex-wrap gap-x-4 gap-y-2 mt-1">
                                                        {dayData.costs.map((cost, cIdx) => (
                                                            <span key={cIdx} className={`inline-flex items-center gap-1 bg-slate-50 px-2 py-0.5 rounded border border-slate-100 text-xs text-slate-600 ${isEditMode ? 'w-full sm:w-auto' : ''}`}>
                                                                {isEditMode ? (
                                                                    <>
                                                                        <input 
                                                                            value={cost.label}
                                                                            onChange={(e) => handleCostChange(activeTab, index, cIdx, 'label', e.target.value)}
                                                                            className="w-20 border-b border-slate-300"
                                                                        />: 
                                                                        <input 
                                                                            value={cost.value}
                                                                            onChange={(e) => handleCostChange(activeTab, index, cIdx, 'value', e.target.value)}
                                                                            className="w-16 border-b border-slate-300 mx-1"
                                                                        />
                                                                        <input 
                                                                            type="number"
                                                                            value={cost.amount}
                                                                            onChange={(e) => handleCostChange(activeTab, index, cIdx, 'amount', Number(e.target.value))}
                                                                            className="w-16 border-b border-slate-300 bg-slate-100"
                                                                            placeholder="é‡‘é¡"
                                                                        />
                                                                    </>
                                                                ) : (
                                                                    <>{cost.label}: <span className="font-semibold text-slate-800">{cost.value}</span></>
                                                                )}
                                                            </span>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            ))}
                            
                            {/* Add New Day Button */}
                            {isEditMode && (
                                <button 
                                    onClick={() => addNewDay(activeTab)}
                                    className="w-full py-4 border-2 border-dashed border-slate-300 rounded-2xl text-slate-400 hover:border-slate-500 hover:text-slate-600 hover:bg-slate-50 transition-all flex items-center justify-center gap-2"
                                >
                                    <Icon name="plus" size={20} /> æ–°å¢ä¸€å¤©è¡Œç¨‹
                                </button>
                            )}
                        </div>

                        {/* Footer Quote */}
                        <div className="mt-12 text-center text-slate-400 text-sm italic">
                            "The world is a book and those who do not travel read only one page."
                        </div>
                    </main>

                    {/* Floating Action Buttons */}
                    <div className="fixed bottom-6 right-6 flex flex-col gap-3 z-50">
                        {isEditMode && (
                            <button 
                                onClick={resetData}
                                className="bg-slate-200 text-slate-600 p-3 rounded-full shadow-lg hover:bg-slate-300 transition-all"
                                title="é‡ç½®å›é è¨­è³‡æ–™"
                            >
                                <Icon name="refresh" size={24} />
                            </button>
                        )}
                        <button 
                            onClick={() => setIsEditMode(!isEditMode)}
                            className={`p-4 rounded-full shadow-lg transition-all ${isEditMode ? 'bg-rose-500 text-white rotate-0' : 'bg-slate-800 text-white hover:bg-slate-700'}`}
                            title={isEditMode ? "å®Œæˆç·¨è¼¯" : "é€²å…¥ç·¨è¼¯æ¨¡å¼"}
                        >
                            {isEditMode ? <Icon name="check" size={24} /> : <Icon name="edit" size={24} />}
                        </button>
                    </div>

                    {isEditMode && (
                        <div className="fixed bottom-6 left-6 bg-rose-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-bounce">
                            âœï¸ ç·¨è¼¯æ¨¡å¼ä¸­ (ä¿®æ”¹å°‡è‡ªå‹•å„²å­˜)
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ItineraryApp />);
    </script>
</body>
</html>